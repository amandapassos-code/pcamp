<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Retorno - relevanC</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React e ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* Anima√ß√£o de Flash para o Resultado */
        @keyframes flash-red {
            0% { background-color: rgba(254, 75, 75, 0.2); }
            100% { background-color: transparent; }
        }
        .animate-flash {
            animation: flash-red 1s ease-out;
        }

        /* Cor personalizada da marca */
        .text-brand { color: #FE4B4B; }
        .bg-brand { background-color: #FE4B4B; }
        .border-brand { border-color: #FE4B4B; }
        .accent-brand { accent-color: #FE4B4B; }
        
        /* Remove setas do input number */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // --- ESTADOS ---
            const [mode, setMode] = useState('calc_investment'); 
            
            const [audience, setAudience] = useState(3000);
            const [duration, setDuration] = useState(7);
            const [investment, setInvestment] = useState(2000);
            const [roas, setRoas] = useState(2.5);

            const [flash, setFlash] = useState(false);

            // --- L√ìGICA DE C√ÅLCULO ---
            const triggerFlash = () => {
                setFlash(true);
                setTimeout(() => setFlash(false), 1000);
            };

            const calculate = (triggerSource, newVal) => {
                let currentAudience = audience;
                let currentDuration = duration;
                let currentRoas = roas;
                let currentInvestment = investment;

                if (triggerSource === 'audience') { setAudience(newVal); currentAudience = newVal; }
                if (triggerSource === 'duration') { setDuration(newVal); currentDuration = newVal; }
                if (triggerSource === 'roas') { setRoas(newVal); currentRoas = newVal; }
                if (triggerSource === 'investment') { setInvestment(newVal); currentInvestment = newVal; }

                // Matem√°tica fict√≠cia (para o MVP)
                const baseCost = (currentAudience * 0.4) + (currentDuration * 100);

                if (mode === 'calc_investment') {
                    if (triggerSource !== 'investment') {
                        let calcInv = baseCost * (1.5 / Math.max(0.1, currentRoas));
                        calcInv = Math.max(100, Math.round(calcInv));
                        setInvestment(calcInv);
                        triggerFlash();
                    }
                } else {
                    if (triggerSource !== 'roas') {
                        let calcRoas = (1.5 * baseCost) / Math.max(100, currentInvestment);
                        calcRoas = parseFloat(Math.max(0.1, calcRoas).toFixed(2));
                        setRoas(calcRoas);
                        triggerFlash();
                    }
                }
            };

            useEffect(() => {
                triggerFlash();
                if (mode === 'calc_investment') {
                    calculate('roas', roas); 
                } else {
                    calculate('investment', investment);
                }
            }, [mode]);

            // Formata√ß√£o de n√∫mero
            const formatNumber = (num) => {
                return new Intl.NumberFormat('pt-BR').format(num);
            };

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 md:p-8 font-sans">
                    
                    <div className="w-full max-w-5xl bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100">
                        
                        {/* HEADER */}
                        <div className="bg-gray-100 px-6 py-4 flex flex-col md:flex-row gap-4 justify-between items-center border-b border-gray-200">
                            
                            {/* Logo & T√≠tulo */}
                            <div className="flex items-center gap-4">
                                <img 
                                    src="./Logo-Master-relevanC-@4x (1).png" 
                                    alt="Logo relevanC" 
                                    className="h-10 md:h-12 object-contain"
                                    onError={(e) => {
                                        e.target.style.display = 'none'; // Esconde se n√£o encontrar a imagem
                                        document.getElementById('logo-fallback').style.display = 'block';
                                    }}
                                />
                                {/* Fallback caso a imagem n√£o esteja na pasta */}
                                <span id="logo-fallback" className="hidden text-2xl font-bold text-gray-800 tracking-tighter">
                                    relevan<span className="text-[#FE4B4B] underline">C</span>
                                </span>
                                
                                <div className="h-8 w-px bg-gray-300 hidden md:block"></div>
                                
                                <h1 className="text-lg font-bold uppercase tracking-wide text-gray-600">
                                    Planejador de Campanha
                                </h1>
                            </div>
                            
                            {/* Toggle de Modos */}
                            <div className="flex bg-white rounded-full p-1 shadow-sm">
                                <button 
                                    onClick={() => setMode('calc_investment')}
                                    className={`px-4 py-2 rounded-full text-xs md:text-sm font-bold transition-all duration-300 ${
                                        mode === 'calc_investment' 
                                        ? 'bg-brand text-white shadow-md' 
                                        : 'text-gray-400 hover:text-gray-600'
                                    }`}
                                    style={{ backgroundColor: mode === 'calc_investment' ? '#FE4B4B' : '' }}
                                >
                                    Descobrir Investimento
                                </button>
                                <button 
                                    onClick={() => setMode('calc_roas')}
                                    className={`px-4 py-2 rounded-full text-xs md:text-sm font-bold transition-all duration-300 ${
                                        mode === 'calc_roas' 
                                        ? 'bg-brand text-white shadow-md' 
                                        : 'text-gray-400 hover:text-gray-600'
                                    }`}
                                    style={{ backgroundColor: mode === 'calc_roas' ? '#FE4B4B' : '' }}
                                >
                                    Tenho Or√ßamento Fixo
                                </button>
                            </div>
                        </div>

                        <div className="p-8 md:p-12">
                            
                            {/* SE√á√ÉO PRINCIPAL: AUDI√äNCIA (Renomeada) */}
                            <div className="mb-16 flex flex-col items-center">
                                <label className="block text-lg font-bold mb-3 text-gray-800">
                                    Tamanho da Base
                                </label>
                                <div className="relative group">
                                    <input
                                        type="text"
                                        inputMode="numeric"
                                        value={audience > 0 ? formatNumber(audience) : ''}
                                        placeholder="0"
                                        onChange={(e) => {
                                            // Remove tudo que n√£o for n√∫mero (pontos, letras) para c√°lculo
                                            const rawValue = e.target.value.replace(/\D/g, '');
                                            const numericValue = rawValue ? parseInt(rawValue, 10) : 0;
                                            calculate('audience', numericValue);
                                        }}
                                        className="w-72 h-20 bg-gray-50 rounded-2xl text-center text-3xl font-bold text-gray-700 border-2 border-gray-200 focus:border-[#FE4B4B] focus:outline-none transition-all shadow-inner"
                                    />
                                    <div className="absolute -bottom-8 left-0 right-0 text-center text-[#FE4B4B] font-bold text-sm tracking-wider uppercase">
                                        Shoppers na Audi√™ncia
                                    </div>
                                    <div className="absolute top-1/2 -translate-y-1/2 right-4 text-gray-300 pointer-events-none">
                                        üë•
                                    </div>
                                </div>
                            </div>

                            <hr className="border-gray-100 mb-16" />

                            {/* GRID DE SLIDERS */}
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-16 items-start">
                                
                                {/* 1. DURA√á√ÉO */}
                                <ControlGroup 
                                    label="Dura√ß√£o da Campanha"
                                    suffix="dias"
                                    value={duration}
                                    min={1}
                                    max={60}
                                    step={1}
                                    onChange={(v) => calculate('duration', v)}
                                    isOutput={false}
                                />

                                {/* 2. INVESTIMENTO */}
                                <ControlGroup 
                                    label="Investimento Total"
                                    prefix="R$"
                                    value={investment}
                                    min={100}
                                    max={50000}
                                    step={100}
                                    onChange={(v) => calculate('investment', v)}
                                    isOutput={mode === 'calc_investment'}
                                    flash={mode === 'calc_investment' && flash}
                                    useThousands={true}
                                />

                                {/* 3. ROAS */}
                                <ControlGroup 
                                    label="ROAS Esperado"
                                    suffix="x"
                                    value={roas}
                                    min={0.1}
                                    max={15.0}
                                    step={0.1}
                                    onChange={(v) => calculate('roas', v)}
                                    isOutput={mode === 'calc_roas'}
                                    flash={mode === 'calc_roas' && flash}
                                />

                            </div>
                        </div>
                        
                        {/* FOOTER */}
                        <div className="bg-gray-50 p-4 text-center text-gray-400 text-xs flex justify-center items-center gap-2">
                             <span>&copy; 2024 relevanC. Todos os direitos reservados.</span>
                        </div>
                    </div>
                </div>
            );
        };

        // --- COMPONENTE REUTILIZ√ÅVEL ---
        const ControlGroup = ({ label, value, min, max, step, onChange, isOutput, prefix, suffix, flash, useThousands }) => {
            const handleChange = (e) => {
                if (isOutput) return; 
                onChange(Number(e.target.value));
            };
            const handleTextChange = (e) => {
                 if (isOutput) return;
                 let val = e.target.value;
                 
                 // Se usar milhares, removemos tudo que n√£o √© n√∫mero antes de converter
                 if (useThousands) {
                     val = val.replace(/\D/g, '');
                 }
                 
                 onChange(Number(val));
            };

            return (
                <div className={`flex flex-col gap-4 p-4 rounded-xl transition-colors duration-500 ${flash ? 'animate-flash' : ''} ${isOutput ? 'bg-gray-50 border border-gray-100' : ''}`}>
                    <div className="flex justify-between items-end h-8">
                        <label className="font-bold text-gray-700 text-sm uppercase tracking-wide">
                            {label}
                        </label>
                        {isOutput && (
                            <span className="text-[10px] font-bold text-white bg-gray-400 px-2 py-0.5 rounded uppercase">
                                Resultado
                            </span>
                        )}
                    </div>

                    <div className="relative w-full h-6 flex items-center">
                        <input
                            type="range"
                            min={min}
                            max={max}
                            step={step}
                            value={value}
                            onChange={handleChange}
                            disabled={isOutput}
                            className="absolute w-full h-full opacity-0 z-20 cursor-pointer disabled:cursor-not-allowed"
                        />
                        <div className="absolute w-full h-3 bg-gray-200 rounded-full overflow-hidden z-0">
                            <div 
                                className={`h-full ${isOutput ? 'bg-gray-300' : 'bg-[#FE4B4B]'} opacity-30`} 
                                style={{ width: `${((value - min) / (max - min)) * 100}%` }}
                            ></div>
                        </div>
                        <div 
                            className={`absolute h-6 w-6 rounded-full shadow-md z-10 pointer-events-none transition-all duration-100 flex items-center justify-center ${isOutput ? 'bg-gray-400' : 'bg-white border-4 border-[#FE4B4B]'}`}
                            style={{
                                left: `calc(${((value - min) / (max - min)) * 100}% - 12px)`
                            }}
                        >
                        </div>
                    </div>

                    <div className="relative mt-1">
                        <div className="flex items-center justify-center border-b-2 border-gray-200 focus-within:border-[#FE4B4B] transition-colors pb-1">
                            {prefix && <span className="text-gray-500 font-medium mr-2 text-lg">{prefix}</span>}
                            <input
                                type={useThousands ? "text" : "number"}
                                inputMode={useThousands ? "numeric" : undefined}
                                value={useThousands ? (value ? value.toLocaleString('pt-BR') : '') : value}
                                onChange={handleTextChange}
                                disabled={isOutput}
                                className={`w-28 text-center font-bold text-xl bg-transparent focus:outline-none ${isOutput ? 'text-gray-500' : 'text-gray-800'}`}
                            />
                            {suffix && <span className="text-gray-500 font-medium ml-1 text-sm self-end mb-1">{suffix}</span>}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
